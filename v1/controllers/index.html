<!doctype html>
  <html>
  <head>
  	<meta charset="utf-8">
  	<title>Controllers - Gophersaurus - The Golang Framework For APIs</title>
  	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  	<meta name="author" content="Jack Spirou">
  	<meta name="description" content="Gophersaurus - The Golang Framework For APIs.">
  	<meta name="keywords" content="gophersaurus, golang, framework, api, jack spirou">
  	<meta name="viewport" content="width=device-width, initial-scale=1">
  	
  	<link rel="stylesheet" href="https://gophersaurus.github.io/docs/css/style.css">
  	<link rel="apple-touch-icon" href="https://gophersaurus.github.io/docs/favicon.png">
  </head>

  <body class="docs language-php">



<nav class="main">
  <div class="container">
    <a href="https://gophersaurus.github.io/docs/" class="brand">
      <img src="https://gophersaurus.github.io/docs/img/gophersaurus_trim_blue.png" height="30" alt="gophersaurus logo">
      gophersaurus
		</a>

    <div class="responsive-sidebar-nav">
		  <a href="#" class="toggle-slide menu-link btn">â˜°</a>
		</div>


		<div class="switcher">
      <div class="dropdown">
		    <button class="btn dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
			    v1
			    <span class="caret"></span>
		</button>
		<ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">

        
            
                <li role="presentation">
                      <a role="menuitem" tabindex="-1" href="https://gophersaurus.github.io/docs/v1">v1</a>
                </li>
            
        
		</ul>
	</div>
</div>


			<ul class="main-nav">
				<li class="nav-docs"><a href="https://gophersaurus.github.io/docs/v1/">overview</a></li>
        <li class="nav-lumen"><a href="https://github.com/gophersaurus/gf">gf</a></li>
        <li class="nav-docs"><a href="https://godoc.org/github.com/gophersaurus/gf.v1">api</a></li>
        <li class="nav-lumen"><a href="https://github.com/gophersaurus/govend">govend</a></li>
        <li class="nav-lumen"><a href="https://github.com/gophersaurus/framework"><img style="position: relative; top: 10px;" src="https://gophersaurus.github.io/docs/img/GitHub-Mark-32px.png"/></a></li>
			</ul>
		</div>
	</nav>


<div class="docs-wrapper container">
	<aside>
		<section class="sidebar">
	
	
			<ul>
				<li>
					Prologue
					<ul>
						
							
								
									<li><a href="https://gophersaurus.github.io/docs/v1/api/">API</a></li>
								
							
						
					</ul>
				</li>
			</ul>
	
			<ul>
				<li>
					Setup
					<ul>
						
							
								
									<li><a href="https://gophersaurus.github.io/docs/v1/">Install</a></li>
								
							
						
					</ul>
				</li>
			</ul>
	
			<ul>
				<li>
					Basics
					<ul>
						
							
								
									<li><a href="https://gophersaurus.github.io/docs/v1/controllers/">Controllers</a></li>
								
							
						
					</ul>
				</li>
			</ul>
	
			<ul>
				<li>
					Architecture
					<ul>
						
					</ul>
				</li>
			</ul>
	
			<ul>
				<li>
					Services
					<ul>
						
					</ul>
				</li>
			</ul>
	
			<ul>
				<li>
					Database Admin
					<ul>
						
					</ul>
				</li>
			</ul>
	
</section>

	</aside>

	<article article style="opacity: 1;">
		<h1>Controllers</h1>
		

<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#basic-controllers">Basic Controllers</a></li>
<li><a href="#controller-middleware">Controller Middleware</a></li>
<li><a href="#restful-resource-controllers">RESTful Resource Controllers</a></li>
</ul>

<p><a name="introduction"></a></p>

<h2 id="introduction:568eb592fd969d4a574c5d9eabbcb4c8">Introduction</h2>

<p>Instead of defining all of your request handling logic in a single <code>routes.go</code> file, you may wish to organize this behavior using controller structures.
Controller structs can group related HTTP request handling logic into a single object.
Controllers are stored in the <code>controllers</code> package located in the <code>app/controllers/</code> directory.</p>

<p><a name="basic-controllers"></a></p>

<h2 id="basic-controllers:568eb592fd969d4a574c5d9eabbcb4c8">Basic Controllers</h2>

<p>Below is an example of a very simple home controller struct located at <code>/app/controllers/home.go</code>.
All Gophersaurus controllers are simply structs.
We recommend the pattern of declaring anonymous public structs:</p>

<pre><code class="language-go">package controllers

import &quot;github.com/gophersaurus/gf.v1/http&quot;

// Home is a controller.
var Home = struct {
  Welcome func(resp http.Responder, req *http.Request)
}{

  // Welcome is an action method for a GET request.
  Welcome: func(resp http.Responder, req *http.Request) {
    resp.Write(req, &quot;Welcome fellow gopher.&quot;)
  },
}
</code></pre>

<p>We can route to the controller action like so in <code>/app/routes.go</code>:</p>

<pre><code class="language-go">package app

import (
  c &quot;github.com/gophersaurus/project/app/controllers&quot;
  &quot;github.com/gophersaurus/gf.v1/router&quot;
)

func register(r router.Router) {
  r.GET(&quot;/welcome&quot;, c.Home.Welcome)
}
</code></pre>

<p>Now, when a request matches the specified route URI <code>/welcome</code>, the <code>Welcome</code> method attached to the <code>Home</code> controller will be executed.
Of course, the route parameters will also be passed to the method via the <code>http.Request</code> argument.</p>

<h4 id="controllers-namespaces:568eb592fd969d4a574c5d9eabbcb4c8">Controllers &amp; Namespaces</h4>

<p>It is helpful to note that the namespace for the <code>controllers</code> package was <code>c</code> in the example above.
The line <code>import c &quot;github.com/gophersaurus/project/app/controllers&quot;</code> allows us to reference the <code>controller</code> package without typing the full word &ldquo;controller&rdquo;.
This is a useful convention when specifying multiple routes so that <code>controllers.Home.Welcome</code> becomes <code>c.Home.Welcome</code>.</p>

<p>Below is an example with the shorter namespace:</p>

<pre><code class="language-go">func register(r router.Router) {
  r.GET(&quot;/&quot;, c.Home.Index)
  r.GET(&quot;/weather/:city&quot;, c.Weather.Show)
  r.GET(&quot;/stocks/:exchange/:stock&quot;, c.Stocks.Show)
  r.GET(&quot;/v2/stocks/:exchange/:stock&quot;, c.StocksV2.Show)
}
</code></pre>

<p><a name="controller-middleware"></a></p>

<h2 id="controller-middleware:568eb592fd969d4a574c5d9eabbcb4c8">Controller Middleware</h2>

<p><a href="https://godoc.org/github.com/gophersaurus/gf.v1/router#Middleware">Middleware</a> has been designed to bridge the <code>router</code> and <code>controllers</code> packages.
Middleware is defined in the <code>middleware</code> package located in the <code>/app/middleware</code> directory.
The <code>Middleware</code> type represents a function that takes a <code>Handler</code> type and returns a <code>Handler</code> type.
This taking and returns of a <code>Handler</code> type creates a chain of <code>Middleware</code>.</p>

<pre><code class="language-go">type Middleware func(http.Handler) http.Handler
</code></pre>

<p>Typically Middleware is not attached to a particular route, instead it is assigned to a subrouter via the <code>Router.Subrouter</code> method.
This pattern provides a powerful way to secure and version different routes based on different controller&rsquo;s needs. Below is an example:</p>

<pre><code class="language-go">func register(r router.Router) {

  // this subrouter has URI paths prepended with &quot;/v1&quot; for versioning
  v1 := r.Subrouter(&quot;/v1&quot;)

  // admin resources
  admin := v1.Subrouter(&quot;/admin&quot;).Middleware(
    m.SessionAdmin,
    m.SessionRefresh,
  )
}
</code></pre>

<p>The example above defines a <code>v1</code> subrouter.
<code>v1</code> inherits all Middleware (such as API key verification) from the original router.
<code>admin</code> is a subrouter based upon <code>v1</code>.
The <code>Middleware</code> method allows us to attach middleware only to <code>admin</code> routes.</p>

<p><a name="restful-resource-controllers"></a></p>

<h2 id="restful-resource-controllers:568eb592fd969d4a574c5d9eabbcb4c8">RESTful Resource Controllers</h2>

<p>Resource controllers make it painless to build RESTful controllers around resources. For example, you may wish to create a controller that handles HTTP requests regarding &ldquo;photos&rdquo; stored by your application.
The photos controller file would exist at <code>/app/controllers/photos.go</code>.
The controller will contain a method for each of the available resource operations.</p>

<table>
<thead>
<tr>
<th>Verb</th>
<th>Path</th>
<th>Action</th>
<th>Route Method</th>
</tr>
</thead>

<tbody>
<tr>
<td>GET</td>
<td><code>/photo</code></td>
<td>index</td>
<td>photo.Index</td>
</tr>

<tr>
<td>POST</td>
<td><code>/photo</code></td>
<td>store</td>
<td>photo.Store</td>
</tr>

<tr>
<td>GET</td>
<td><code>/photo/{photo}</code></td>
<td>show</td>
<td>photo.Show</td>
</tr>

<tr>
<td>PUT</td>
<td><code>/photo/{photo}</code></td>
<td>apply</td>
<td>photo.Apply</td>
</tr>

<tr>
<td>PATCH</td>
<td><code>/photo/{photo}</code></td>
<td>update</td>
<td>photo.Update</td>
</tr>

<tr>
<td>DELETE</td>
<td><code>/photo/{photo}</code></td>
<td>destroy</td>
<td>photo.Destroy</td>
</tr>
</tbody>
</table>

<p>If a resource controller contains a method for each action method above it will satisfy the <code>Resourcer</code> interface.</p>

<pre><code class="language-go">type Resourcer interface {
  // action methods
  Index(resp http.Responder, req *http.Request)
  Show(resp http.Responder, req *http.Request)
  Store(resp http.Responder, req *http.Request)
  Apply(resp http.Responder, req *http.Request)
  Update(resp http.Responder, req *http.Request)
  Destroy(resp http.Responder, req *http.Request)
}
</code></pre>

<p>Next, you may register a resourceful route to the controller:</p>

<pre><code class="language-go">func register(r router.Router) {
  r.Resource(&quot;/photos&quot;, &quot;photo_id&quot;, c.Photos)
}
</code></pre>

  </article>
</div>


<footer class="main">

		<p>Gophersaurus is a trademark of Jack Spirou. Copyright &copy; Jack Spirou.</p>
		<p class="less-significant"><a href="http://jackmcdade.com">Original Design based on Jack McDade's work</a> - <a href="http://laravel.com">laravel.com</a></p>
	</footer>

	<script>
  var algolia_app_id      = 'SC7K1CQIP8';
	var algolia_search_key  = 'f27109a910f6de8b0d5e270ebf4b1f00';
	var version             = '0.5';
</script>

<script id="search_suggestion_template" type="text/template">
	<div class="autocomplete-wrapper">
		" {{ #_highlightResult.h1 }} "
		<div class="h1">
			"{{{ _highlightResult.h1.value }}}"
		</div>
		\{\{\/_highlightResult\.h1\}\}

		<div class="sub-section">
			\{\{#_highlightResult\.h2\}\}
			<div class="h2">
				<span class="hash">#</span> "{{{ _highlightResult.h2.value }}}"
			</div>
			\{\{\/_highlightResult\.h2\}\}

			\{\{#_highlightResult\.h3\}\}
			<div class="h3">
				> \{\{\{ _highlightResult\.h3\.value \}\}\}
			</div>
			"{{/_highlightResult.h3}}"

			"{{#_highlightResult.h4}}"
			<div class="h4">
				"\u003e {{{ _highlightResult.h4.value }}}"
			</div>
			\{\{\/_highlightResult\.h4\}\}
		</div>

		"{{#_highlightResult.content}}"
		<div class="content">
			"{{{ _highlightResult.content.value }}}"
		</div>
		\{\{\/_highlightResult\.content\}\}
	</div>
</script>

<script id="search_empty_template" type="text/template">
	<div class="autocomplete-wrapper empty">
		<div class="h2">We didn't find any result for \x22{{query}}\x22. Sorry!</div>
	</div>
</script>

<script id="search_footer_template" type="text/template">
	<div class="footer">
		<a target="_blank" href="http://www.algolia.com">
			<img width="50" src="https://gophersaurus.github.io/docs/img/algolia-logo.png"/>
			<div class="powered">powered by</div>
			<div style="clear: both"></div>
		</a>
	</div>
</script>


	<script src="https://gophersaurus.github.io/docs/js/script.js"></script>
	<script src="https://gophersaurus.github.io/docs/js/viewport-units-buggyfill.js"></script>
	<script>window.viewportUnitsBuggyfill.init();</script>
	<script>
		
	</script>
</body>
</html>

